<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Doo Tallks</title>
  <style>
    body {
      background-color: #0f172a;
      color: #f1f5f9;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 40px;
    }
    h1 {
      font-size: 2.5rem;
      color: #38bdf8;
    }
    #output {
      margin-top: 20px;
      font-size: 1.2rem;
      color: #94a3b8;
    }
    .pulse-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      margin-top: 20px;
      height: 40px;
    }
    .pulse-bar {
      width: 6px;
      height: 20px;
      background: #38bdf8;
      animation: pulse 1s infinite ease-in-out;
    }
    .pulse-bar:nth-child(1) { animation-delay: 0s; }
    .pulse-bar:nth-child(2) { animation-delay: 0.2s; }
    .pulse-bar:nth-child(3) { animation-delay: 0.4s; }
    .pulse-bar:nth-child(4) { animation-delay: 0.6s; }
    .pulse-bar:nth-child(5) { animation-delay: 0.8s; }

    @keyframes pulse {
      0%, 100% { height: 10px; }
      50% { height: 30px; }
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Doo Tallks</h1>
  <div class="pulse-container hidden" id="pulse">
    <div class="pulse-bar"></div>
    <div class="pulse-bar"></div>
    <div class="pulse-bar"></div>
    <div class="pulse-bar"></div>
    <div class="pulse-bar"></div>
  </div>
  <p id="output">Say "Hey dude" to start...</p>

  <script>
    const output = document.getElementById("output");
    const pulse = document.getElementById("pulse");

    function showPulse(text) {
      pulse.classList.remove("hidden");
      output.textContent = text;
    }

    function hidePulse() {
      pulse.classList.add("hidden");
    }

    function startWakeWordListener() {
      const wakeRecognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      wakeRecognition.lang = 'en-US';
      wakeRecognition.interimResults = false;

      wakeRecognition.onstart = () => {
        showPulse("ðŸŽ§ Listening for 'Hey dude'...");
      };

      wakeRecognition.onresult = (event) => {
        hidePulse();
        const transcript = event.results[0][0].transcript.toLowerCase();
        output.textContent = `You said: "${transcript}"`;

        if (transcript.includes("hey dude")) {
          output.textContent = "Doo Tallks activated! ðŸŽ‰ Listening for commands...";
          setTimeout(() => startCommandListener(), 1000);
        } else {
          output.textContent = "Say 'Hey dude' to activate.";
          setTimeout(() => startWakeWordListener(), 1000);
        }
      };

      wakeRecognition.onerror = () => {
        hidePulse();
        output.textContent = "Mic error. Retrying...";
        setTimeout(() => startWakeWordListener(), 1000);
      };

      wakeRecognition.start();
    }

    function startCommandListener() {
      const commandRecognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      commandRecognition.lang = 'en-US';
      commandRecognition.interimResults = false;

      commandRecognition.onstart = () => {
        showPulse("ðŸŽ¤ Listening for command...");
      };

      commandRecognition.onresult = (event) => {
        hidePulse();
        const command = event.results[0][0].transcript.toLowerCase();
        output.textContent = `Command: "${command}"`;

        if (command.includes("shutdown")) {
          output.textContent = "Doo Tallks shut down. Say 'Hey dude' to reactivate.";
          setTimeout(() => startWakeWordListener(), 2000);
          return;
        }

        if (command.includes("youtube")) {
          window.location.href = "vnd.youtube://";
        } else if (command.includes("instagram")) {
          window.location.href = "intent://instagram.com/#Intent;package=com.instagram.android;scheme=https;end";
        } else if (command.includes("chrome")) {
          output.textContent = "Bhai tu toh already Chrome pe hai! ðŸ˜‚";
        } else if (command.includes("time")) {
          const now = new Date();
          output.textContent = "Time is: " + now.toLocaleTimeString();
        } else if (command.includes("hello")) {
          output.textContent = "Hello bro! ðŸ˜Ž";
        } else if (command.includes("your name")) {
          output.textContent = "I am Doo Tallks â€” your AI buddy ðŸ˜Ž";
        } else if (command.includes("how are you")) {
          output.textContent = "I'm feeling smart today! ðŸ’¡";
        } else if (command.includes("what can you do")) {
          output.textContent = "I can open apps, tell time, and follow your voice commands!";
        } else if (command.includes("what's the weather") || command.includes("weather")) {
          output.textContent = "Weather feature coming soon! â›…";
        } else if (command.includes("open your enemy")) {
          window.open("https://chat.openai.com", "_blank");
        } else if (command.includes("search for")) {
          const query = command.replace("search for", "").trim();
          const searchURL = "https://www.google.com/search?q=" + encodeURIComponent(query);
          window.open(searchURL, "_blank");
        } else {
          output.textContent = "Command not recognized.";
        }

        // Delay of 10 seconds before listening again
        setTimeout(() => startCommandListener(), 10000);
      };

      commandRecognition.onerror = () => {
        hidePulse();
        output.textContent = "Mic error. Restarting command mode...";
        setTimeout(() => startCommandListener(), 1000);
      };

      commandRecognition.start();
    }

    // Auto start wake word on page load
    window.onload = () => {
      startWakeWordListener();
    };
  </script>
</body>
</html>
